<div class="dashboard-container">
  <!-- Dynamic Floating Navigation -->
  <nav class="floating-nav" [class.expanded]="navExpanded" (mouseenter)="expandNav()" (mouseleave)="collapseNav()">
    <div class="nav-header">
      <img src="assets/Ollo-Logo.webp" alt="OLLO" class="nav-logo" 
           onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
      <i class="fas fa-cube nav-logo-fallback" style="display: none;"></i>
      <span class="nav-title" *ngIf="navExpanded">OLLO</span>
    </div>
    
    <div class="nav-items">
      <div class="nav-section">
        <div class="nav-item active" (click)="setActiveSection('dashboard')">
          <i class="fas fa-th-large"></i>
          <span *ngIf="navExpanded">Dashboard</span>
        </div>
        <div class="nav-sub-items" *ngIf="navExpanded && activeSection === 'dashboard'">
          <div class="nav-sub-item active">Dashboard</div>
          <div class="nav-sub-item">CMS Dashboard</div>
          <div class="nav-sub-item">HR Dashboard</div>
        </div>
      </div>
      
      <div class="nav-item" (click)="setActiveSection('settings')">
        <i class="fas fa-cog"></i>
        <span *ngIf="navExpanded">Settings</span>
      </div>
      
      <div class="nav-item" (click)="setActiveSection('hr')">
        <i class="fas fa-users"></i>
        <span *ngIf="navExpanded">HR</span>
      </div>
      
      <div class="nav-item" (click)="setActiveSection('finance')">
        <i class="fas fa-dollar-sign"></i>
        <span *ngIf="navExpanded">Finance</span>
      </div>
    </div>
  </nav>

  <!-- Top Bar -->
  <header class="top-bar">
    <div class="top-bar-content">
      <div class="welcome-section">
        <h2 class="greeting">Good {{ getGreeting() }},</h2>
        <h1 class="username">{{ currentUser?.username || 'User' }}</h1>
      </div>
      
      <div class="top-bar-actions">
        <button class="icon-btn" title="Notifications">
          <i class="fas fa-bell"></i>
          <span class="badge">3</span>
        </button>
        <button class="icon-btn" title="Language">
          <i class="fas fa-globe"></i>
        </button>
        <button class="icon-btn" title="Theme">
          <i class="fas fa-moon"></i>
        </button>
        <button class="icon-btn" title="Color Palette">
          <i class="fas fa-palette"></i>
        </button>
        <div class="profile-section" (click)="toggleProfileMenu()">
          <div class="profile-avatar">
            <img [src]="currentUser?.avatar || 'assets/default-avatar.png'" 
                 alt="Profile" 
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            <div class="avatar-fallback">
              <i class="fas fa-user"></i>
            </div>
          </div>
          <div class="profile-info">
            <span class="profile-name">{{ currentUser?.username }}</span>
            <span class="profile-role">Administrator</span>
          </div>
          <i class="fas fa-chevron-down profile-arrow"></i>
        </div>
        
        <!-- Profile Dropdown -->
        <div class="profile-dropdown" *ngIf="showProfileMenu">
          <div class="dropdown-item">
            <i class="fas fa-user-circle"></i>
            Profile Settings
          </div>
          <div class="dropdown-item">
            <i class="fas fa-cog"></i>
            Preferences
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item logout" (click)="logout()">
            <i class="fas fa-sign-out-alt"></i>
            Logout
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content" [class.nav-expanded]="navExpanded">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <div class="stat-card appointments">
        <div class="stat-icon">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">New Appointments</div>
          <div class="stat-value">{{ stats.appointments }}</div>
          <div class="stat-change positive">+12% from last week</div>
        </div>
        <div class="stat-chart">
          <div class="mini-chart">
            <div class="chart-bar" style="height: 20%"></div>
            <div class="chart-bar" style="height: 45%"></div>
            <div class="chart-bar" style="height: 30%"></div>
            <div class="chart-bar" style="height: 60%"></div>
            <div class="chart-bar" style="height: 80%"></div>
          </div>
        </div>
      </div>

      <div class="stat-card surveys">
        <div class="stat-icon">
          <i class="fas fa-poll"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">Pending Surveys</div>
          <div class="stat-value">{{ stats.surveys }}</div>
          <div class="stat-change negative">-5% from yesterday</div>
        </div>
        <div class="stat-chart">
          <div class="circular-progress">
            <svg viewBox="0 0 36 36">
              <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
              <path class="circle" stroke-dasharray="75, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"/>
            </svg>
            <div class="percentage">75%</div>
          </div>
        </div>
      </div>

      <div class="stat-card satisfaction">
        <div class="stat-icon">
          <i class="fas fa-heart"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">Patient Satisfaction</div>
          <div class="stat-value">{{ stats.satisfaction }}</div>
          <div class="stat-change positive">+3% from last month</div>
        </div>
        <div class="satisfaction-indicator">
          <div class="satisfaction-level" [style.width.%]="stats.satisfaction * 20"></div>
        </div>
      </div>

      <div class="stat-card notifications">
        <div class="stat-icon">
          <i class="fas fa-bell"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">System Notifications</div>
          <div class="stat-value">{{ stats.notifications }}</div>
          <div class="stat-change neutral">No change</div>
        </div>
        <div class="notification-list">
          <div class="notification-item" *ngFor="let notification of recentNotifications">
            <div class="notification-dot" [class]="notification.type"></div>
            <span class="notification-text">{{ notification.message }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Dashboard Cards -->
    <div class="dashboard-grid">
      <div class="dashboard-card appointments-card">
        <div class="card-header">
          <h3>Today's Schedule</h3>
          <span class="card-subtitle">{{ getCurrentDate() }}</span>
        </div>
        <div class="card-content">
          <div class="appointment-list">
            <div class="appointment-item" *ngFor="let appointment of todayAppointments">
              <div class="appointment-time">{{ appointment.time }}</div>
              <div class="appointment-details">
                <div class="appointment-patient">{{ appointment.patient }}</div>
                <div class="appointment-type">{{ appointment.type }}</div>
              </div>
              <div class="appointment-status" [class]="appointment.status">
                {{ appointment.status }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="dashboard-card activity-card">
        <div class="card-header">
          <h3>System Activity</h3>
          <span class="card-subtitle">Real-time monitoring</span>
        </div>
        <div class="card-content">
          <div class="activity-list">
            <div class="activity-item" *ngFor="let activity of systemActivity">
              <div class="activity-icon" [class]="activity.type">
                <i [class]="activity.icon"></i>
              </div>
              <div class="activity-details">
                <div class="activity-message">{{ activity.message }}</div>
                <div class="activity-time">{{ activity.timestamp | date:'short' }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="dashboard-card performance-card">
        <div class="card-header">
          <h3>Performance Metrics</h3>
          <span class="card-subtitle">This month overview</span>
        </div>
        <div class="card-content">
          <div class="performance-metrics">
            <div class="metric">
              <div class="metric-label">Response Time</div>
              <div class="metric-value">1.2s</div>
              <div class="metric-indicator good"></div>
            </div>
            <div class="metric">
              <div class="metric-label">Uptime</div>
              <div class="metric-value">99.9%</div>
              <div class="metric-indicator excellent"></div>
            </div>
            <div class="metric">
              <div class="metric-label">Error Rate</div>
              <div class="metric-value">0.1%</div>
              <div class="metric-indicator excellent"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>